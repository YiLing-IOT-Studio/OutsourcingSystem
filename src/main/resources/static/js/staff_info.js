/**
 * Created by 杨玉卿 on 2018/4/10.
 */
//加载个人信息
$.ajax({
        type:"post",
        url:"/staff/getUserInfo",
        dataType:"json",
        data:{},
        success:function(data){
            //显示资料部分
            $("#profile").css('display','block');
            //隐藏编辑部分
            $("#second_profile").css('display','none');
            //填充资料信息
            $("#true_name1").text(data[0].myName);
            if(data[0].gender=='gentleman'){
                data[0].gender='男';
            }
            else{data[0].gender='女'}
            $("#gender1").text(data[0].gender);
            $("#telephone1").text(data[0].username);
            $("#company1").text(data[0].company);
            $("#job1").text(data[0].job);
            $("#introduce1").text(data[0].introduce);
            if(data[0].obey=="on"){
                data[0].obey='遵守协议';
            }
            else{data[0].obey='未签订';}
            $("#promise").text(data[0].obey);

            $("#true_name").val(data[0].myName);
            $("#gender").val(data[0].gender);
            $("#company").val(data[0].company);
            $("#job").val(data[0].job);
            $("#introduce").val(data[0].introduce);

        },
        error:function(){
            alert("请求失败");
        }
});
//点击编辑
$("#edit").click(function(){
    //已有资料隐藏
    $("#second_profile").css('display','block');
    //修改资料显示
    $("#profile").css('display','none');

});
//用户修改信息..

//点击保存
$("#save").click(function(){
    //判断修改信息是否含有空选项
    if($("#true_name").val()==""||$("#company").val()==""||$("#job").val()==""||$("#introduce").val()==""){
        alert("您的资料还未填写完整，请填写完整后提交!");
    }
    //提交修改资料
    else{
        //发送给服务器
        $.ajax({
            type:'post',
            url:'/',
            dataType:"json",
            data:{
                "staff_name":$("#true_name").val(),
                "staff_gender":$("#gender").val(),
                "staff_company":$("#company").val(),
                "staff_job":$("#job").val(),
                "staff_introduce":$("#introduce").val()
            },
            success:function(data){
                //保存后...
                //显示资料部分
                $("#profile").css('display','block');
                //隐藏编辑部分
                $("#second_profile").css('display','none');
                //填充资料信息
                $("#true_name1").text(data[0].myName);
                if(data[0].gender=='gentleman'){
                    data[0].gender='男';
                }
                else{data[0].gender='女'}
                $("#gender1").text(data[0].gender);
                $("#telephone1").text(data[0].username);
                $("#company1").text(data[0].company);
                $("#job1").text(data[0].job);
                $("#introduce1").text(data[0].introduce);
                if(data[0].obey=="on"){
                    data[0].obey='遵守协议';
                }
                else{data[0].obey='未签订';}
                $("#promise").text(data[0].obey);

                $("#true_name").val(data[0].myName);
                $("#gender").val(data[0].gender);
                $("#company").val(data[0].company);
                $("#job").val(data[0].job);
                $("#introduce").val(data[0].introduce);
            },
            error:function(){
                alert("请求失败");
            }
        })
    }
});
//点击个人档
$("#li_info_item").click(function(){
    /*关闭video*/
    var video=document.getElementById('video');
    video.pause();
    $("#video").css("visibility","hidden");
    window.clearInterval(time1);

    //加载个人资料信息
    $.ajax({
        type:"post",
        url:"/staff/getUserInfo",
        dataType:"json",
        data:{},
        success:function(data){
            //显示资料部分
            $("#profile").css('display','block');
            //隐藏编辑部分
            $("#second_profile").css('display','none');
            //填充资料信息
            $("#true_name1").text(data[0].myName);
            if(data[0].gender=='gentleman'){
                data[0].gender='男';
            }
            else{data[0].gender='女'}
            $("#gender1").text(data[0].gender);
            $("#telephone1").text(data[0].username);
            $("#company1").text(data[0].company);
            $("#job1").text(data[0].job);
            $("#introduce1").text(data[0].introduce);
            if(data[0].obey=="on"){
                data[0].obey='遵守协议';
            }
            else{data[0].obey='未签订';}
            $("#promise").text(data[0].obey);

            $("#true_name").val(data[0].myName);
            $("#gender").val(data[0].gender);
            $("#company").val(data[0].company);
            $("#job").val(data[0].job);
            $("#introduce").val(data[0].introduce);
        },
        error:function(){
            alert("请求失败");
        }
    });
});




